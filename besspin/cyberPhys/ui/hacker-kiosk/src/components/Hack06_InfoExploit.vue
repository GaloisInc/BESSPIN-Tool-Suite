<!--

"EXPLOIT COMPLETE"

TODO:
* @dmz how is the hack actually executed?

-->
<template>
  <div id="hack06">
      
      <!-- Data Exfil Button -->
      <button class="hack06-exfil-btn img-btn" @click="exfil()"></button>

      <div id="exfil-msg" class="status-msg">{{ exfilMessage }}</div>

      <!-- Radio Station Buttons -->
      <button class="hack06-station1-btn img-btn" @click="changeStation(1)"></button>
      <button class="hack06-station2-btn img-btn" @click="changeStation(2)"></button>
      <button class="hack06-station3-btn img-btn" @click="changeStation(3)"></button>

      <div id="station-msg" class="status-msg">{{ stationMessage }}</div>

      <!-- Volume Buttons -->
      <button class="hack06-down-btn img-btn" @click="volumeDown()"></button>
      <button class="hack06-up-btn img-btn" @click="volumeUp()"></button>

      <div id="volume-msg" class="status-msg">{{ volumeMessage }}</div>

      <router-link v-if="clickCount >= 1" class="hack06-next-btn img-btn" to="/hack07_critical_attempt" tag="button">
      </router-link>

  </div>
</template>

<style scoped>
  .status-msg {
    font-size: 2em;
    font-family: 'Roboto Mono', monospace;
    position: absolute;
    width: 810px;
    left: 120px;
  }
  #volume-msg {
    top: 1520px;
  }
  #station-msg {
    top: 1050px;
  }
  #exfil-msg {
    top: 580px;
  }

  #hack06 {
    background-image: url('/hack06_infoExploit/hack06_infoExploit_noBTN.png');
    height: 1920px;
    width: 1080px;
    text-align: center;
  }
  .hack06-exfil-btn {
    background-image: url('/hack06_infoExploit/hack06_infoExploit_gps_btn.png');
    width: 555px;
    height: 170px;
    top: 375px;
    left: 260px;
  }
  .hack06-exfil-btn:active {
    background-image: url('/hack06_infoExploit/hack06_infoExploit_gps_btnHIT.png');
    background-position-x: -25px;
    background-position-y: -25px;
  }

  .hack06-station1-btn {
    background-image: url('/hack06_infoExploit/hack06_infoExploit_radio_btn1.png');
    background-position-x: -20px;
    width: 220px;
    height: 170px;
    top: 852px;
    left: 200px;
  }
  .hack06-station1-btn:active {
    background-image: url('/hack06_infoExploit/hack06_infoExploit_radio_btn1_HIT.png');
    background-position-x: -45px;
    background-position-y: -25px;

  }

  .hack06-station2-btn {
    background-image: url('/hack06_infoExploit/hack06_infoExploit_radio_btn2.png');
    background-position-x: -20px;
    width: 220px;
    height: 170px;
    top: 852px;
    left: 420px;
  }
  .hack06-station2-btn:active {
    background-image: url('/hack06_infoExploit/hack06_infoExploit_radio_btn2_HIT.png');
    background-position-x: -45px;
    background-position-y: -25px;
  }

  .hack06-station3-btn {
    background-image: url('/hack06_infoExploit/hack06_infoExploit_radio_btn3.png');
    background-position-x: -20px;
    width: 220px;
    height: 170px;
    top: 852px;
    left: 640px;
  }
  .hack06-station3-btn:active {
    background-image: url('/hack06_infoExploit/hack06_infoExploit_radio_btn3_HIT.png');
    background-position-x: -45px;
    background-position-y: -25px;
  }

  .hack06-up-btn {
    background-image: url('/hack06_infoExploit/hack06_infoExploit_up_btn.png');
    width: 250px;
    height: 170px;
    top: 1320px;
    left: 290px;
  }
  .hack06-up-btn:active {
    background-image: url('/hack06_infoExploit/hack06_infoExploit_up_btnHIT.png');
    background-position-x: -5px;
    background-position-y: -5px;
  }

  .hack06-down-btn {
    background-image: url('/hack06_infoExploit/hack06_infoExploit_down_btn.png');
    width: 250px;
    height: 170px;
    top: 1320px;
    left: 540px;
  }
  .hack06-down-btn:active {
    background-image: url('/hack06_infoExploit/hack06_infoExploit_down_btnHIT.png');
    background-position-x: -25px;
    background-position-y: -25px;
  }

  .hack06-next-btn {
    background-image: url('/hack05_infoAttempt/hack05_infoAttempt_btn.png');
    width: calc(716px * .8);
    height: calc(272px * .8);
    background-size: 70%;
    top: 1630px;
    left: 340px;
  }
  .hack06-next-btn:active {
    background-image: url('/hack05_infoAttempt/hack05_infoAttempt_btnHIT.png');
  }


</style>


<script>

  const electron = require('electron')
  const ipc = electron.ipcRenderer;

  export default {
    name: 'Hack06_InfoExploit',
    props: {
    },
    data() {
      return {
        messages: [],
        clickCount: 0,
        stationMessage: "",
        exfilMessage: "",
        volumeMessage: "",
        poller: setInterval(() => { this.pollState() }, 500)
      }
    },
    mounted() {
      ipc.on('zmq-results',(event, q) => {
        q.forEach(item => {
          if(item.func == this.$options.name + '_changeStation' && item.status == 200) {
            this.stationMessage = "Station set to " + item.retval;
          } else if (item.func == this.$options.name + '_volumeUp' && item.status == 200) {
            this.volumeMessage = "Volume Increased";
          } else if (item.func == this.$options.name + '_volumeDown' && item.status == 200) {
            this.volumeMessage = "Volume Decreased";
          } else if (item.func == this.$options.name + '_exfil') {
            this.exfilMessage = item.retval.toString();
          }
        });
      });
    },
    unmounted() {
      clearInterval(this.poller);
    },
    methods: {
      pollState() {
        ipc.send('zmq-poll', []);
      },
      exfil() {
        console.log("[click] data Exfil");
        this.clickCount++;
        ipc.send('button-pressed', this.$options.name + '_exfil', {});
      },
      changeStation(which) {
        console.log("[click] change to station ", which)
        this.clickCount++;
        ipc.send('button-pressed', this.$options.name + '_changeStation', which);
      },
      volumeUp() {
        console.log("[click] volumeUp")
        this.clickCount++;
        ipc.send('button-pressed', this.$options.name + '_volumeUp',{});
      },
      volumeDown() {
        console.log("[click] volumeDown");
        this.clickCount++;
        ipc.send('button-pressed', this.$options.name + '_volumeDown',{});
      }
    }
  };
</script>
